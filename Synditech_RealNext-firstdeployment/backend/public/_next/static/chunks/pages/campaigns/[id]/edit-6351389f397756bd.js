(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3344],{44297:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/campaigns/[id]/edit",function(){return a(59019)}])},59019:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(85893),r=a(67294),l=a(11163),i=a(80195),n=a(1153),d=a(21438),c=a(86501),o=a(48974),m=a(52418),u=a(7543),x=a(20445),h=a(52913),g=a(82911),p=a(10050),b=a(51446),f=a(31038);let j=[{id:1,name:"Basic Info",icon:o.Z},{id:2,name:"Template",icon:m.Z},{id:3,name:"Audience",icon:u.Z},{id:4,name:"Schedule",icon:x.Z}];function y(){var e;let t=(0,l.useRouter)(),{id:a}=t.query,{user:o,loading:m}=(0,n.a)(),[u,x]=(0,r.useState)(1),[y,w]=(0,r.useState)(!0),[v,N]=(0,r.useState)(!1),[k,C]=(0,r.useState)([]),[Z,E]=(0,r.useState)([]),[_,I]=(0,r.useState)({name:"",description:"",templateId:"",audienceType:"all",audienceFilters:{},scheduledAt:null,isImmediate:!0});(0,r.useEffect)(()=>{m||o?o&&a&&L():t.push("/")},[o,m,a]);let L=async()=>{try{let[e,t,s]=await Promise.all([d.qd.getCampaign(a),d.J5.getTemplates(),d.LM.getLeads({limit:100})]),r=e.data.data;I({name:r.name,description:r.description||"",templateId:r.template_id,audienceType:r.audience_type||"all",audienceFilters:r.audience_filters||{},scheduledAt:r.scheduled_at?r.scheduled_at.slice(0,16):null,isImmediate:!r.scheduled_at}),C(t.data.data.filter(e=>e.is_approved)),E(s.data.data)}catch(e){console.error("Failed to fetch initial data:",e),c.ZP.error("Failed to load campaign data")}finally{w(!1)}},T=async()=>{N(!0);try{let e={..._,scheduled_at:_.isImmediate?null:_.scheduledAt};await d.qd.updateCampaign(a,e),c.ZP.success("Campaign updated successfully!"),t.push("/campaigns")}catch(e){console.error("Failed to update campaign:",e),c.ZP.error("Failed to update campaign")}finally{N(!1)}};return m||y?(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):(0,s.jsx)(i.Z,{children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>t.back(),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(h.Z,{className:"h-6 w-6 text-gray-600"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Campaign"})]}),(0,s.jsx)("nav",{"aria-label":"Progress",children:(0,s.jsx)("ol",{role:"list",className:"flex items-center",children:j.map((e,t)=>(0,s.jsxs)("li",{className:"relative ".concat(t!==j.length-1?"pr-8 sm:pr-20":""),children:[(0,s.jsxs)("div",{className:"flex items-center","aria-hidden":"true",children:[(0,s.jsx)("div",{className:"relative flex h-10 w-10 items-center justify-center rounded-full border-2 transition-colors ".concat(e.id<u?"bg-blue-600 border-blue-600":e.id===u?"border-blue-600":"border-gray-300"),children:e.id<u?(0,s.jsx)(g.Z,{className:"h-6 w-6 text-white"}):(0,s.jsx)(e.icon,{className:"h-6 w-6 ".concat(e.id===u?"text-blue-600":"text-gray-400")})}),t!==j.length-1&&(0,s.jsx)("div",{className:"absolute top-5 left-10 -ml-px h-0.5 w-full transition-colors ".concat(e.id<u?"bg-blue-600":"bg-gray-300"),style:{width:"calc(100% - 40px)"}})]}),(0,s.jsx)("div",{className:"mt-2 block text-xs font-semibold text-gray-500 uppercase tracking-wide",children:e.name})]},e.name))})}),(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 sm:p-8",children:[1===u&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Campaign Name"}),(0,s.jsx)("input",{type:"text",value:_.name,onChange:e=>I({..._,name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,s.jsx)("textarea",{rows:4,value:_.description,onChange:e=>I({..._,description:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]})]}),2===u&&(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:k.map(e=>{var t;return(0,s.jsxs)("div",{onClick:()=>I({..._,templateId:e.id}),className:"cursor-pointer rounded-lg border-2 p-4 transition-all hover:shadow-md ".concat(_.templateId===e.id?"border-blue-500 bg-blue-50":"border-gray-200"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900",children:e.name}),_.templateId===e.id&&(0,s.jsx)(p.Z,{className:"h-5 w-5 text-blue-500"})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-gray-500 uppercase",children:e.category}),(0,s.jsx)("p",{className:"mt-2 line-clamp-2 text-sm text-gray-600",children:(null===(t=e.content)||void 0===t?void 0:t.body)||"No preview available"})]},e.id)})}),3===u&&(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("button",{onClick:()=>I({..._,audienceType:"all"}),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("all"===_.audienceType?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:["All Leads (",Z.length,")"]}),(0,s.jsx)("button",{onClick:()=>I({..._,audienceType:"segment"}),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("segment"===_.audienceType?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Custom Segment"})]})}),4===u&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 bg-gray-50",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900 border-b pb-2 mb-4",children:"Final Review"}),(0,s.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-4 sm:grid-cols-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-gray-500",children:"Campaign Name"}),(0,s.jsx)("dd",{className:"font-medium",children:_.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("dt",{className:"text-gray-500",children:"Template"}),(0,s.jsx)("dd",{className:"font-medium",children:(null===(e=k.find(e=>e.id===_.templateId))||void 0===e?void 0:e.name)||"N/A"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"immediate",type:"radio",checked:_.isImmediate,onChange:()=>I({..._,isImmediate:!0}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"immediate",className:"ml-3 text-sm font-medium text-gray-700",children:"Immediate/Draft"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"scheduled",type:"radio",checked:!_.isImmediate,onChange:()=>I({..._,isImmediate:!1}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"scheduled",className:"ml-3 text-sm font-medium text-gray-700",children:"Schedule for Later"})]}),!_.isImmediate&&(0,s.jsx)("input",{type:"datetime-local",value:_.scheduledAt||"",onChange:e=>I({..._,scheduledAt:e.target.value}),className:"mt-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center py-4",children:[u>1?(0,s.jsxs)("button",{onClick:()=>{x(e=>e-1)},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:[(0,s.jsx)(b.Z,{className:"h-5 w-5 mr-1"}),"Back"]}):(0,s.jsx)("div",{}),u<j.length?(0,s.jsxs)("button",{onClick:()=>{if(1===u&&!_.name){c.ZP.error("Campaign name is required");return}if(2===u&&!_.templateId){c.ZP.error("Please select a template");return}x(e=>e+1)},className:"inline-flex items-center px-6 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 shadow-sm transition-all",children:["Next",(0,s.jsx)(f.Z,{className:"h-5 w-5 ml-1"})]}):(0,s.jsxs)("button",{onClick:T,disabled:v,className:"inline-flex items-center px-8 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 shadow-sm transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50",children:[v?"Updating...":"Update Campaign",!v&&(0,s.jsx)(g.Z,{className:"h-5 w-5 ml-2"})]})]})]})})}},52913:function(e,t,a){"use strict";var s=a(67294);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))});t.Z=r},10050:function(e,t,a){"use strict";var s=a(67294);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=r},82911:function(e,t,a){"use strict";var s=a(67294);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))});t.Z=r},20445:function(e,t,a){"use strict";var s=a(67294);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=r},48974:function(e,t,a){"use strict";var s=a(67294);let r=s.forwardRef(function({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))});t.Z=r}},function(e){e.O(0,[1664,9638,195,9774,2888,179],function(){return e(e.s=44297)}),_N_E=e.O()}]);