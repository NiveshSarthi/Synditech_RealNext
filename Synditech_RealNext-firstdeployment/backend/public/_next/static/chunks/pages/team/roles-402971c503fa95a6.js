(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4061],{22081:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/team/roles",function(){return t(67877)}])},90618:function(e,r,t){"use strict";t.d(r,{z:function(){return a}});var s=t(85893);let a=t(67294).forwardRef((e,r)=>{let{children:t,variant:a="primary",size:n="md",className:o="",isLoading:i=!1,disabled:l,...c}=e;return(0,s.jsxs)("button",{ref:r,className:"\n        ".concat("inline-flex items-center justify-center rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none active:scale-95 ring-offset-background"," \n        ").concat({primary:"bg-primary text-[#0E1117] hover:bg-primary/90 shadow-[0_0_15px_rgba(249,115,22,0.3)] hover:shadow-[0_0_20px_rgba(249,115,22,0.5)] border border-transparent",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 border border-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",link:"text-primary underline-offset-4 hover:underline"}[a]," \n        ").concat({sm:"h-8 px-3 text-xs",md:"h-10 px-4 py-2 text-sm",lg:"h-12 px-8 text-base",icon:"h-10 w-10"}[n]," \n        ").concat(i?"opacity-70 cursor-wait":"","\n        ").concat(o,"\n      "),disabled:l||i,...c,children:[i&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t]})});a.displayName="Button"},67877:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return b}});var s=t(85893),a=t(67294),n=t(11163),o=t(80195),i=t(87066),l=t(86501),c=t(59968),d=t(78680),m=t(48974),u=t(76249),x=t(31415),h=t(82911),p=t(90618);let f="http://localhost:5001";function b(){let e=(0,n.useRouter)(),[r,t]=(0,a.useState)([]),[b,g]=(0,a.useState)({}),[v,y]=(0,a.useState)(!0),[w,j]=(0,a.useState)(!1),[N,k]=(0,a.useState)(null),[E,Z]=(0,a.useState)({name:"",description:"",permissions:[]});(0,a.useEffect)(()=>{(()=>{let r=localStorage.getItem("user");if(r)try{var t;let s=JSON.parse(r),a=null==s?void 0:null===(t=s.context)||void 0===t?void 0:t.tenantRole;if("admin"!==a&&"manager"!==a){l.ZP.error("You do not have permission to access this page"),e.push("/analytics");return}}catch(e){console.error("Error parsing user data:",e)}})()},[e]),(0,a.useEffect)(()=>{C(),_()},[]);let C=async()=>{try{let e=localStorage.getItem("access_token"),r=await i.Z.get("".concat(f,"/api/roles"),{headers:{Authorization:"Bearer ".concat(e)}});t(r.data.data.tenant_roles||[])}catch(e){console.error("Error fetching roles:",e),l.ZP.error("Failed to load roles")}finally{y(!1)}},_=async()=>{try{let e=localStorage.getItem("access_token"),r=await i.Z.get("".concat(f,"/api/roles/permissions"),{headers:{Authorization:"Bearer ".concat(e)}});g(r.data.data.grouped||{})}catch(e){console.error("Error fetching permissions:",e)}},R=async e=>{e.preventDefault();try{let e=localStorage.getItem("access_token");N?(await i.Z.patch("".concat(f,"/api/roles/").concat(N.id),E,{headers:{Authorization:"Bearer ".concat(e)}}),l.ZP.success("Role updated successfully!")):(await i.Z.post("".concat(f,"/api/roles"),E,{headers:{Authorization:"Bearer ".concat(e)}}),l.ZP.success("Role created successfully!")),j(!1),k(null),Z({name:"",description:"",permissions:[]}),C()}catch(e){var r,t;l.ZP.error((null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.error)||"Failed to save role")}},S=async(e,r)=>{if(confirm('Are you sure you want to delete the role "'.concat(r,'"?')))try{let r=localStorage.getItem("access_token");await i.Z.delete("".concat(f,"/api/roles/").concat(e),{headers:{Authorization:"Bearer ".concat(r)}}),C(),l.ZP.success("Role deleted successfully")}catch(e){var t,s;l.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to delete role")}},L=e=>{k(e),Z({name:e.name,description:e.description,permissions:e.permissions||[]}),j(!0)},B=e=>{Z(r=>({...r,permissions:r.permissions.includes(e)?r.permissions.filter(r=>r!==e):[...r.permissions,e]}))},z=e=>{let r=b[e].map(e=>e.code);r.every(e=>E.permissions.includes(e))?Z(e=>({...e,permissions:e.permissions.filter(e=>!r.includes(e))})):Z(e=>({...e,permissions:[...new Set([...e.permissions,...r])]}))};return v?(0,s.jsx)(o.Z,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}):(0,s.jsxs)(o.Z,{children:[(0,s.jsxs)("div",{className:"space-y-8 animate-fade-in content-container",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-white tracking-tight flex items-center gap-3",children:[(0,s.jsx)(c.Z,{className:"w-8 h-8 text-primary"}),"Role Management"]}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-400",children:"Create and manage custom roles with specific permissions"})]}),(0,s.jsxs)(p.z,{onClick:()=>{k(null),Z({name:"",description:"",permissions:[]}),j(!0)},variant:"primary",className:"shadow-glow-sm",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),"Create Role"]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===r.length?(0,s.jsx)("div",{className:"col-span-full",children:(0,s.jsxs)("div",{className:"text-center py-20 bg-card/30 border border-white/5 rounded-2xl border-dashed",children:[(0,s.jsx)("div",{className:"h-20 w-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(c.Z,{className:"h-10 w-10 text-primary"})}),(0,s.jsx)("h3",{className:"text-xl font-medium text-white",children:"No custom roles yet"}),(0,s.jsx)("p",{className:"mt-2 text-gray-500 max-w-sm mx-auto",children:"Create your first custom role to manage team permissions effectively."}),(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsxs)(p.z,{onClick:()=>j(!0),variant:"primary",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),"Create First Role"]})})]})}):r.map(e=>{var r;return(0,s.jsxs)("div",{className:"bg-card border border-border/50 rounded-xl p-6 hover:border-primary/50 transition-all duration-300 shadow-soft group",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-white mb-1",children:e.name}),e.is_system&&(0,s.jsx)("span",{className:"inline-block px-2 py-0.5 text-xs bg-blue-500/10 text-blue-400 rounded-full border border-blue-500/20",children:"System Role"})]}),!e.is_system&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>L(e),className:"p-2 rounded-lg text-gray-400 hover:text-primary hover:bg-primary/10 transition-colors",title:"Edit role",children:(0,s.jsx)(m.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>S(e.id,e.name),className:"p-2 rounded-lg text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-colors",title:"Delete role",children:(0,s.jsx)(u.Z,{className:"w-4 h-4"})})]})]}),(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-4 line-clamp-2 min-h-[40px]",children:e.description||"No description provided"}),(0,s.jsx)("div",{className:"border-t border-border/50 pt-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-400",children:"Permissions"}),(0,s.jsx)("span",{className:"px-2.5 py-0.5 text-xs font-semibold bg-primary/10 text-primary rounded-full border border-primary/20",children:(null===(r=e.permissions)||void 0===r?void 0:r.length)||0})]})})]},e.id)})})]}),w&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 overflow-y-auto p-4",children:(0,s.jsxs)("div",{className:"bg-card border border-border/50 rounded-xl shadow-2xl p-8 max-w-4xl w-full my-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:N?"Edit Role":"Create New Role"}),(0,s.jsx)("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-white transition-colors",children:(0,s.jsx)(x.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("form",{onSubmit:R,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Role Name *"}),(0,s.jsx)("input",{type:"text",required:!0,value:E.name,onChange:e=>Z({...E,name:e.target.value}),className:"w-full px-4 py-2.5 bg-[#161B22] border border-border/50 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g., Sales Manager"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),(0,s.jsx)("textarea",{value:E.description,onChange:e=>Z({...E,description:e.target.value}),rows:3,className:"w-full px-4 py-2.5 bg-[#161B22] border border-border/50 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Brief description of this role..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-4",children:"Permissions"}),(0,s.jsx)("div",{className:"space-y-6 max-h-96 overflow-y-auto bg-[#0E1117] rounded-lg p-4 border border-border/50",children:Object.entries(b).map(e=>{let[r,t]=e;return(0,s.jsxs)("div",{className:"border-b border-border/50 pb-4 last:border-b-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h4",{className:"font-semibold text-white capitalize",children:r}),(0,s.jsx)("button",{type:"button",onClick:()=>z(r),className:"text-sm text-primary hover:text-primary/80 transition-colors",children:t.every(e=>E.permissions.includes(e.code))?"Deselect All":"Select All"})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-3",children:t.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer group",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"checkbox",checked:E.permissions.includes(e.code),onChange:()=>B(e.code),className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-border/50 rounded peer-checked:bg-primary peer-checked:border-primary transition-all flex items-center justify-center",children:E.permissions.includes(e.code)&&(0,s.jsx)(h.Z,{className:"w-3 h-3 text-black"})})]}),(0,s.jsx)("span",{className:"text-sm text-gray-300 group-hover:text-white transition-colors",children:e.name})]},e.code))})]},r)})}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[E.permissions.length," permission",1!==E.permissions.length?"s":""," selected"]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)(p.z,{type:"button",onClick:()=>j(!1),variant:"outline",className:"flex-1",children:"Cancel"}),(0,s.jsx)(p.z,{type:"submit",variant:"primary",className:"flex-1",children:N?"Update Role":"Create Role"})]})]})]})})]})}},82911:function(e,r,t){"use strict";var s=t(67294);let a=s.forwardRef(function({title:e,titleId:r,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},t),e?s.createElement("title",{id:r},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))});r.Z=a},48974:function(e,r,t){"use strict";var s=t(67294);let a=s.forwardRef(function({title:e,titleId:r,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},t),e?s.createElement("title",{id:r},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))});r.Z=a},78680:function(e,r,t){"use strict";var s=t(67294);let a=s.forwardRef(function({title:e,titleId:r,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},t),e?s.createElement("title",{id:r},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});r.Z=a},59968:function(e,r,t){"use strict";var s=t(67294);let a=s.forwardRef(function({title:e,titleId:r,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},t),e?s.createElement("title",{id:r},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))});r.Z=a},76249:function(e,r,t){"use strict";var s=t(67294);let a=s.forwardRef(function({title:e,titleId:r,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},t),e?s.createElement("title",{id:r},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});r.Z=a}},function(e){e.O(0,[1664,9638,195,9774,2888,179],function(){return e(e.s=22081)}),_N_E=e.O()}]);