(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1032],{39437:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/payments",function(){return s(75343)}])},75343:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var r=s(85893),a=s(67294),n=s(11163),l=s(80195),d=s(1153),i=s(21438),o=s(86501),c=s(10050),m=s(20445),x=s(5362),u=s(98523),h=s(61612),f=s(85973),p=s(77495);let g=e=>{let{plan:t,currentPlan:s,onSelect:a}=e,n=s===t.tier;return(0,r.jsxs)("div",{className:"card transition-all duration-300 hover:shadow-lg hover:-translate-y-1 relative overflow-hidden ".concat(n?"ring-2 ring-primary":""),children:[n&&(0,r.jsx)("div",{className:"absolute top-0 right-0 p-2",children:(0,r.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-primary/10 text-primary",children:"Current Plan"})}),(0,r.jsxs)("div",{className:"card-content p-6 flex flex-col h-full",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-foreground mb-2",children:t.name}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-6",children:"Perfect for scaling your business"}),(0,r.jsx)("div",{className:"mb-6",children:t.price_monthly?(0,r.jsxs)("div",{className:"flex items-baseline",children:[(0,r.jsxs)("span",{className:"text-4xl font-extrabold text-foreground",children:["₹",t.price_monthly.toLocaleString()]}),(0,r.jsx)("span",{className:"text-muted-foreground ml-1",children:"/month"})]}):(0,r.jsx)("span",{className:"text-3xl font-bold text-foreground",children:"Contact Sales"})}),(0,r.jsx)("ul",{className:"space-y-4 mb-8 flex-1",children:(Array.isArray(t.features)?t.features:"object"==typeof t.features&&null!==t.features?Object.entries(t.features).map(e=>{let[t,s]=e;return"".concat(t.replace(/_/g," "),": ").concat(s)}):[]).map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)(c.Z,{className:"h-5 w-5 text-green-500 mr-3 flex-shrink-0 mt-0.5"}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:e})]},t))}),n?(0,r.jsx)("button",{disabled:!0,className:"btn w-full bg-muted text-muted-foreground cursor-not-allowed",children:"Current Plan"}):(0,r.jsx)("button",{onClick:()=>a(t),className:"btn btn-primary w-full shadow-md hover:shadow-lg",children:s?"Upgrade":"Subscribe Now"})]})]})},j=e=>{let{payment:t,onDownloadInvoice:s}=e;return(0,r.jsxs)("tr",{className:"hover:bg-muted/30 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(e=>{switch(e){case"completed":return(0,r.jsx)(c.Z,{className:"h-5 w-5 text-green-500"});case"pending":return(0,r.jsx)(m.Z,{className:"h-5 w-5 text-yellow-500"});case"failed":return(0,r.jsx)(x.Z,{className:"h-5 w-5 text-red-500"});default:return(0,r.jsx)(m.Z,{className:"h-5 w-5 text-muted-foreground"})}})(t.status),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-foreground capitalize",children:t.payment_type}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:t.description})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat((e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-secondary text-secondary-foreground"}})(t.status)),children:t.status})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-foreground",children:["₹",t.amount.toLocaleString()]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground capitalize",children:t.gateway}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground",children:new Date(t.created_at).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:"completed"===t.status&&(0,r.jsx)("button",{onClick:()=>s(t),className:"text-primary hover:text-primary-focus transition-colors",title:"Download Invoice",children:(0,r.jsx)(u.Z,{className:"h-5 w-5"})})})]})};function N(){var e,t;let[s,x]=(0,a.useState)("plans"),[u,N]=(0,a.useState)([]),[b,v]=(0,a.useState)([]),[w,y]=(0,a.useState)(null),[k,Z]=(0,a.useState)(!0),[S,_]=(0,a.useState)(null),{user:E,loading:P}=(0,d.a)(),C=(0,n.useRouter)();(0,a.useEffect)(()=>{P||E?E&&(L(),M(),A(),D()):C.push("/")},[E,P]);let L=async()=>{try{let e=await i.iV.getPlans();N(e.data.data)}catch(e){console.error("Failed to fetch plans:",e)}},M=async()=>{try{let e=await i.iV.getHistory();v(e.data.data)}catch(e){console.error("Failed to fetch payments:",e)}},A=async()=>{try{let e=await i.iV.getStats();y(e.data.data)}catch(e){console.error("Failed to fetch payment stats:",e)}finally{Z(!1)}},D=async()=>{try{let e=await i.iV.getCurrentSubscription();e.data.data&&_(e.data.data.plan_tier)}catch(e){console.error("Failed to fetch current subscription:",e)}},O=async e=>{try{let t=await i.iV.createSubscription({planId:e.id,gateway:"razorpay"});t.data.success&&(o.ZP.success("Subscription created! Redirecting to payment..."),console.log("Payment order created:",t.data.data))}catch(e){console.error("Failed to create subscription:",e),o.ZP.error("Failed to create subscription")}},T=async e=>{try{let t=await i.iV.getInvoice(e.id);o.ZP.success("Invoice downloaded successfully"),console.log("Invoice data:",t.data.data)}catch(e){console.error("Failed to download invoice:",e),o.ZP.error("Failed to download invoice")}};return k||P?(0,r.jsx)(l.Z,{children:(0,r.jsx)("div",{className:"flex h-[calc(100vh-4rem)] w-full items-center justify-center",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"h-12 w-12 rounded-full border-4 border-muted"}),(0,r.jsx)("div",{className:"absolute top-0 h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"})]})})}):(0,r.jsx)(l.Z,{children:(0,r.jsxs)("div",{className:"space-y-8 animate-fade-in container-custom py-8",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Payments & Billing"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Manage your subscription and payment history"})]})}),w&&(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"card-content p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 p-3 bg-blue-50 rounded-xl",children:(0,r.jsx)(h.Z,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsx)("div",{className:"ml-4 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-muted-foreground truncate",children:"Total Revenue"}),(0,r.jsxs)("dd",{className:"text-xl font-bold text-foreground mt-1",children:["₹",(null===(e=w.total_amount)||void 0===e?void 0:e.toLocaleString())||0]})]})})]})})}),(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"card-content p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 p-3 bg-green-50 rounded-xl",children:(0,r.jsx)(c.Z,{className:"h-6 w-6 text-green-600"})}),(0,r.jsx)("div",{className:"ml-4 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-muted-foreground truncate",children:"Completed Payments"}),(0,r.jsx)("dd",{className:"text-xl font-bold text-foreground mt-1",children:w.completed_payments||0})]})})]})})}),(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"card-content p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 p-3 bg-yellow-50 rounded-xl",children:(0,r.jsx)(m.Z,{className:"h-6 w-6 text-yellow-600"})}),(0,r.jsx)("div",{className:"ml-4 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-muted-foreground truncate",children:"Pending Payments"}),(0,r.jsx)("dd",{className:"text-xl font-bold text-foreground mt-1",children:w.pending_payments||0})]})})]})})}),(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"card-content p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 p-3 bg-indigo-50 rounded-xl",children:(0,r.jsx)(f.Z,{className:"h-6 w-6 text-indigo-600"})}),(0,r.jsx)("div",{className:"ml-4 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-muted-foreground truncate",children:"Avg Payment Amount"}),(0,r.jsxs)("dd",{className:"text-xl font-bold text-foreground mt-1",children:["₹",w.avg_payment_amount?Math.round(w.avg_payment_amount).toLocaleString():0]})]})})]})})})]}),(0,r.jsx)("div",{className:"border-b border-border",children:(0,r.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"plans",name:"Subscription Plans"},{id:"history",name:"Payment History"}].map(e=>(0,r.jsx)("button",{onClick:()=>x(e.id),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ".concat(s===e.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-border"),children:e.name},e.id))})}),(0,r.jsxs)("div",{className:"min-h-[400px]",children:["plans"===s&&(0,r.jsxs)("div",{className:"animate-fade-in",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Choose the right plan for you"}),(0,r.jsx)("p",{className:"mt-2 text-muted-foreground",children:"Unlock advanced features and scale your business"})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3",children:u.map(e=>(0,r.jsx)(g,{plan:e,currentPlan:S,onSelect:O},e.id))}),S&&(0,r.jsxs)("div",{className:"mt-12 bg-muted/30 border border-border rounded-xl p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Current Subscription Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"p-4 bg-background rounded-lg border border-border/50",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Active Plan"}),(0,r.jsx)("p",{className:"text-xl font-bold text-primary",children:(null===(t=u.find(e=>e.tier===S))||void 0===t?void 0:t.name)||"Unknown"})]}),(0,r.jsxs)("div",{className:"p-4 bg-background rounded-lg border border-border/50",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Next Billing Date"}),(0,r.jsx)("p",{className:"text-xl font-bold text-foreground",children:new Date(Date.now()+2592e6).toLocaleDateString()})]})]})]})]}),"history"===s&&(0,r.jsx)("div",{className:"animate-fade-in",children:(0,r.jsx)("div",{className:"card overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,r.jsx)("thead",{className:"bg-muted/50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-[10px] font-bold text-muted-foreground",children:"PAYMENT"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-[10px] font-bold text-muted-foreground",children:"STATUS"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-[10px] font-bold text-muted-foreground",children:"AMOUNT"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-[10px] font-bold text-muted-foreground",children:"GATEWAY"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-[10px] font-bold text-muted-foreground",children:"DATE"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-[10px] font-bold text-muted-foreground",children:"ACTIONS"})]})}),(0,r.jsx)("tbody",{className:"bg-card divide-y divide-border/50",children:0===b.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"6",className:"px-6 py-12 text-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-full bg-muted mb-4",children:(0,r.jsx)(p.Z,{className:"h-6 w-6 text-muted-foreground"})}),(0,r.jsx)("h3",{className:"text-sm font-medium text-foreground",children:"No payments found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Your payment history will appear here."})]})})}):b.map(e=>(0,r.jsx)(j,{payment:e,onDownloadInvoice:T},e.id))})]})})})})]})]})})}},85973:function(e,t,s){"use strict";var r=s(67294);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))});t.Z=a},10050:function(e,t,s){"use strict";var r=s(67294);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=a},20445:function(e,t,s){"use strict";var r=s(67294);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=a},61612:function(e,t,s){"use strict";var r=s(67294);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 8.25H9m6 3H9m3 6-3-3h1.5a3 3 0 1 0 0-6M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=a},5362:function(e,t,s){"use strict";var r=s(67294);let a=r.forwardRef(function({title:e,titleId:t,...s},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=a}},function(e){e.O(0,[1664,9638,195,9774,2888,179],function(){return e(e.s=39437)}),_N_E=e.O()}]);